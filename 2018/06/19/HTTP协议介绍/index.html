<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="http,">










<meta name="description" content="HTTP协议(HyperText Transfer Protocol，超文本传输协议)是互联网上应用最为广泛的一种网络协议。 所有的WWW文件都必须遵守这个标准。 HTTP是一个基于TCP/IP通信协议来传递数据（HTML 文件, 图片文件, 查询结果等）。 一、套接字概念跨Internet的主机间通讯时，在建立通信连接的每一端，进程间的传输要有两个标志： IP地址和端口号，合称为套接字地址(so">
<meta name="keywords" content="http">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTP协议介绍">
<meta property="og:url" content="http://yoursite.com/2018/06/19/HTTP协议介绍/index.html">
<meta property="og:site_name" content="吕培新的博客">
<meta property="og:description" content="HTTP协议(HyperText Transfer Protocol，超文本传输协议)是互联网上应用最为广泛的一种网络协议。 所有的WWW文件都必须遵守这个标准。 HTTP是一个基于TCP/IP通信协议来传递数据（HTML 文件, 图片文件, 查询结果等）。 一、套接字概念跨Internet的主机间通讯时，在建立通信连接的每一端，进程间的传输要有两个标志： IP地址和端口号，合称为套接字地址(so">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/套接字.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/http通信服务过程1.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/http通信服务过程2.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/请求相应模型.jpg">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/cookie-2.jpg">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/串行连接.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/并行连接.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/持久连接.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/Web服务请求处理步骤.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/请求报文.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/响应报文.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/状态码分类.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/1-27.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/2-29.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/3-29.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/4-1-1.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/4-2-2.png">
<meta property="og:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/5-23.png">
<meta property="og:updated_time" content="2018-08-18T02:03:57.444Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HTTP协议介绍">
<meta name="twitter:description" content="HTTP协议(HyperText Transfer Protocol，超文本传输协议)是互联网上应用最为广泛的一种网络协议。 所有的WWW文件都必须遵守这个标准。 HTTP是一个基于TCP/IP通信协议来传递数据（HTML 文件, 图片文件, 查询结果等）。 一、套接字概念跨Internet的主机间通讯时，在建立通信连接的每一端，进程间的传输要有两个标志： IP地址和端口号，合称为套接字地址(so">
<meta name="twitter:image" content="http://yoursite.com/2018/06/19/HTTP协议介绍/套接字.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/06/19/HTTP协议介绍/">





  <title>HTTP协议介绍 | 吕培新的博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">吕培新的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">生活中没有弱者，只有不愿努力的人。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-computer">
          <a href="/categories/计算机基础" rel="section">
            
            计算机基础
          </a>
        </li>
      
        
        <li class="menu-item menu-item-network">
          <a href="/categories/网络技术" rel="section">
            
            网络技术
          </a>
        </li>
      
        
        <li class="menu-item menu-item-linux">
          <a href="/categories/linux" rel="section">
            
            Linux运维
          </a>
        </li>
      
        
        <li class="menu-item menu-item-shell">
          <a href="/categories/shell脚本" rel="section">
            
            Shell脚本
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sql">
          <a href="/categories/数据库" rel="section">
            
            数据库
          </a>
        </li>
      
        
        <li class="menu-item menu-item-webserver">
          <a href="/categories/Web服务器" rel="section">
            
            Web服务器
          </a>
        </li>
      
        
        <li class="menu-item menu-item-automated">
          <a href="/categories/自动化运维" rel="section">
            
            自动化运维工具
          </a>
        </li>
      
        
        <li class="menu-item menu-item-cluster">
          <a href="/categories/集群" rel="section">
            
            集群
          </a>
        </li>
      
        
        <li class="menu-item menu-item-test">
          <a href="/categories/文本三剑客" rel="section">
            
            文本三剑客
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/19/HTTP协议介绍/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="吕培新">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="吕培新的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">HTTP协议介绍</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-19T13:35:53+08:00">
                2018-06-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/网络技术/" itemprop="url" rel="index">
                    <span itemprop="name">网络技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>HTTP协议</strong>(HyperText Transfer Protocol，超文本传输协议)是互联网上应用最为广泛的一种网络协议。</p>
<p>所有的WWW文件都必须遵守这个标准。</p>
<p><strong>HTTP</strong>是一个基于TCP/IP通信协议来传递数据（HTML 文件, 图片文件, 查询结果等）。</p>
<h2 id="一、套接字概念"><a href="#一、套接字概念" class="headerlink" title="一、套接字概念"></a><strong>一、套接字概念</strong></h2><p>跨Internet的主机间通讯时，在建立通信连接的每一端，进程间的传输要有两个标志：</p>
<p>IP地址和端口号，合称为<strong>套接字地址(socket address)</strong></p>
<p>客户机套接字地址定义了一个唯一的客户进程</p>
<p>服务器套接字地址定义了一个唯一的服务器进程</p>
<p><img src="套接字.png" alt="套接字"></p>
<p><strong>Socket: </strong> 套接字，进程间通信IPC的一种实现，允许位于不同主机（或同一主机）上不同进程之间进行通信和数据交换，SocketAPI出现于1983年，4.2 BSD实现</p>
<p><strong>Socket API</strong>：封装了内核中所提供的socket通信相关的系统调用</p>
<p><strong>Socket Domain</strong>：根据其所使用的地址</p>
<p>​         <strong>AF_INET</strong>：Address Family，IPv4</p>
<p>​         <strong>AF_INET6</strong>：IPv6</p>
<p>​         <strong>AF_UNIX</strong>：同一主机上不同进程之间通信时使用</p>
<p><strong>Socket Type</strong>：根据使用的传输层协议</p>
<p>​         <strong>SOCK_STREAM</strong>：流，tcp套接字，可靠地传递、面向连接</p>
<p>​         <strong>SOCK_DGRAM</strong>：数据报，udp套接字，不可靠地传递、无连接</p>
<p>​         <strong>SOCK_RAW</strong>:  裸套接字,无须tcp或tdp,APP直接通过IP包通信</p>
<h3 id="套接字相关的系统调用："><a href="#套接字相关的系统调用：" class="headerlink" title="套接字相关的系统调用："></a><strong>套接字相关的系统调用：</strong></h3><p><strong>socket():</strong> 创建一个套接字</p>
<p><strong>bind()：</strong>绑定IP和端口</p>
<p><strong>listen()：</strong>监听</p>
<p><strong>accept()：</strong>接收请求</p>
<p><strong>connect()：</strong>请求连接建立</p>
<p><strong>write()：</strong>发送</p>
<p><strong>read()：</strong>接收</p>
<p><strong>close():</strong> 关闭连接</p>
<p>相关通信过程如下图：</p>
<p><img src="http通信服务过程1.png" alt="http通信服务过程1"></p>
<p>​<img src="http通信服务过程2.png" alt="http通信服务过程2"></p>
<h2 id="二、HTTP相关术语"><a href="#二、HTTP相关术语" class="headerlink" title="二、HTTP相关术语"></a><strong>二、HTTP相关术语</strong></h2><p><strong>http: Hyper Text Transfer Protocol</strong>, 80/tcp</p>
<p><strong>html: Hyper Text Markup Language</strong> 超文本标记语言，编程语言</p>
<p><strong>示例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;title&gt;html语言&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;标题1&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;&lt;a href=http://www.lvpeixin.tech&gt;你好&lt;/a&gt;欢迎访问&lt;/p&gt;</span><br><span class="line">    &lt;h2&gt;标题2&lt;/h2&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p><strong>CSS: Cascading Style Sheet</strong> 层叠样式表</p>
<p><strong>js: javascript</strong> </p>
<p><strong>MIME: Multipurpose Internet Mail Extensions:</strong>多用途互联网邮件扩展 </p>
<p>​     是设定某种扩展名的文件用一种应用程序来打开的方式类型，当该扩展名文件被访问的时候，浏览器会自动使用指定应用程序来打开。多用于指定一些客户端自定义的文件名，以及一些媒体文件打开方式。</p>
<p><strong>配置文件：</strong>/etc/mime.types</p>
<p>格式：<strong>major/minor</strong></p>
<p>​       text/plain</p>
<p>​       text/html</p>
<p>​       text/css</p>
<p>​       image/jpeg</p>
<p>​       image/png</p>
<p>​       video/mp4</p>
<p>​       application/javascript</p>
<p>​    参考：<a href="http://www.w3school.com.cn/media/media_mimeref.asp" target="_blank" rel="noopener">http://www.w3school.com.cn/media/media_mimeref.asp</a></p>
<p><strong>URI(Uniform Resource Identifier)</strong>统一资源标识，分为<strong>URL和URN</strong></p>
<p><strong>URN: Uniform Resource Naming</strong>，统一资源命名</p>
<p>​    <strong>示例：</strong> P2P下载使用的磁力链接是URN的一种实现</p>
<p>​         magnet:?xt=urn:btih:660557A6890EF888666</p>
<p><strong>URL: Uniform Resorce Locator</strong>，统一资源定位符，用于描述某服务器某特定资源位置</p>
<h3 id="URN与URL区别："><a href="#URN与URL区别：" class="headerlink" title="URN与URL区别："></a><strong>URN与URL区别：</strong></h3><p>URN如同一个人的名称，而URL代表一个人的住址。换言之，URN定义某事物的身份，</p>
<p>而URL提供查找该事物的方法。URN仅用于命名，而不指定地址</p>
<h3 id="URL的组成"><a href="#URL的组成" class="headerlink" title="URL的组成"></a><strong>URL的组成</strong></h3><p><strong>格式：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;scheme&gt;://&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;path&gt;;&lt;params&gt;?&lt;query&gt;#&lt;frag&gt;</span><br></pre></td></tr></table></figure>
<p><strong>schame:</strong>方案，访问服务器以获取资源时要使用哪种协议</p>
<p><strong>user:</strong>用户，某些方案访问资源时需要的用户名</p>
<p><strong>password:</strong>密码，用户对应的密码，中间用：分隔</p>
<p><strong>Host:</strong>主机，资源宿主服务器的主机名或IP地址</p>
<p><strong>port:</strong>端口,资源宿主服务器正在监听的端口号，很多方案有默认端口号</p>
<p><strong>path:</strong>路径,服务器资源的本地名，由一个/将其与前面的URL组件分隔</p>
<p><strong>params:</strong>参数，指定输入的参数，参数为名/值对，多个参数，用;分隔</p>
<p><strong>query:</strong>查询，传递参数给程序，如数据库，用？分隔,多个查询用&amp;分隔</p>
<p><strong>frag:</strong>片段,一小片或一部分资源的名字，此组件在客户端使用，用#分隔</p>
<p><strong>示例：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://www.lvpeixin.tech:8080/images/logo.jpg</span><br><span class="line">ftp://wang:password@172.16.0.1/pub/linux.ppt</span><br><span class="line">rtsp://videoserver/video_demo/</span><br><span class="line">Real Time Streaming Protocol</span><br><span class="line">http://www.lvpeixin.tech/bbs/hello;gender=f/send;type=title</span><br><span class="line">https://list.jd.com/list.html?cat=670,671,672&amp;ev=149_2992&amp;sort=sort_totalsales15_desc&amp;trans=1</span><br></pre></td></tr></table></figure>
<h3 id="HTTP的历史"><a href="#HTTP的历史" class="headerlink" title="HTTP的历史"></a>HTTP的历史</h3><p><strong>目前主流使用的http版本有1.1版本及2.0版本</strong></p>
<p><strong>http/1.1：1997年1月</strong></p>
<ol>
<li><p>引入了持久连接（persistent connection），即TCP连接默认不关闭，可以被多个请求复用，</p>
<p>不用声明Connection: keep-alive。对于同一个域名，大多数浏览器允许同时建立6个持久连接</p>
</li>
<li><p>引入了管道机制（pipelining），即在同一个TCP连接里，客户端可以同时发送多个请求，</p>
<p>进一步改进了HTTP协议的效率</p>
</li>
<li><p>新增方法：PUT、PATCH、OPTIONS、DELETE</p>
</li>
<li><p>同一个TCP连接里面，所有的数据通信是按次序进行的。服务器只能顺序处理回应，</p>
<p>前面的回应慢，会有许多请求排队，造成”队头堵塞”（Head-of-line blocking）</p>
</li>
<li><p>为避免上述问题，两种方法：一是减少请求数，二是同时多开持久连接。网页优化技巧，</p>
<p>比如合并脚本和样式表、将图片嵌入CSS代码、域名分片（domain sharding）等</p>
</li>
<li><p>HTTP 协议不带有状态，每次请求都必须附上所有信息。请求的很多字段都是重复的，浪费带宽，影响速度</p>
<p><strong>Spdy</strong>：2009年,谷歌研发,解决 HTTP/1.1 效率不高问题</p>
</li>
</ol>
<p><strong>http/2.0：2015年</strong></p>
<ol>
<li><p>头信息和数据体都是二进制，称为头信息帧和数据帧</p>
</li>
<li><p>复用TCP连接，在一个连接里，客户端和浏览器都可以同时发送多个请求或回应，</p>
<p>且不用按顺序一一对应，避免了“队头堵塞“,此双向的实时通信称为多工（Multiplexing）</p>
</li>
<li><p>引入头信息压缩机制（header compression）,头信息使用gzip或compress压缩后再发送；</p>
<p>客户端和服务器同时维护一张头信息表，所有字段都会存入这个表，生成一个索引号，不发送同样字段，</p>
<p>只发送索引号，提高速度</p>
</li>
<li><p>HTTP/2 允许服务器未经请求，主动向客户端发送资源，即服务器推送（server push）</p>
</li>
</ol>
<h2 id="三、HTTP工作机制"><a href="#三、HTTP工作机制" class="headerlink" title="三、HTTP工作机制"></a><strong>三、HTTP工作机制</strong></h2><h3 id="工作机制："><a href="#工作机制：" class="headerlink" title="工作机制："></a><strong>工作机制：</strong></h3><p><strong>http请求：</strong>http request</p>
<p><strong>http响应：</strong>http response</p>
<p>一次http事务：<strong>请求&lt;–&gt;响应</strong></p>
<p><img src="请求相应模型.jpg" alt="请求相应模型"></p>
<p><strong>http协议：stateless 无状态</strong></p>
<p>​    服务器无法持续追踪访问者来源</p>
<p><strong>解决http协议无状态方法:</strong></p>
<p>​    cookie  客户端存放</p>
<p>​    session 服务端存放</p>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a><strong>Cookie</strong></h3><p> HTTP 是一种无状态协议。协议自身不对请求和响应之间的通信状态进行保存。也就是说在 HTTP 这个级别，</p>
<p>协议对于发送过的请求或响应都不做持久化处理。这是为了更快地处理大量事务，确保协议的可伸缩性，</p>
<p>而特意把 HTTP 协议设计成如此简单的。可是随着 Web 的不断发展，很多业务都需要对通信状态进行保存。</p>
<p>于是引入了 Cookie 技术。使用 Cookie 的状态管理Cookie 技术通过在请求和响应报文中写入 Cookie 信息来控制</p>
<p>客户端的状态。Cookie 会根据从服务器端发送的响应报文内的一个叫做 Set-Cookie 的首部字段信息，通知客户端</p>
<p>保存Cookie。当下次客户端再往该服务器发送请求时，客户端会自动在请求报文中加入 Cookie 值后发送出去。</p>
<p>服务器端发现客户端发送过来的 Cookie 后，会去检查究竟是从哪一个客户端发来的连接请求，然后对比服务器上</p>
<p>的记录，最后得到之前的状态信息</p>
<p><img src="cookie-2.jpg" alt="cookie"></p>
<h3 id="Web资源：web-resource"><a href="#Web资源：web-resource" class="headerlink" title="Web资源：web resource"></a><strong>Web资源：</strong>web resource</h3><p>一个网页由多个资源构成，打开一个页面，会有多个资源展示出来，但是每个资源都</p>
<p>要单独请求。因此，一个“Web 页面”通常并不是单个资源，而是一组资源的集合</p>
<p><strong>静态文件：</strong>无需服务端做出额外处理</p>
<p>​    文件后缀：.jpg, .html, .txt, .js, .css, .mp3, .avi</p>
<p><strong>动态文件：</strong>服务端执行程序，返回执行的结果</p>
<p>​     文件后缀：.asp, .php, .jsp</p>
<h3 id="提高HTTP连接性能"><a href="#提高HTTP连接性能" class="headerlink" title="提高HTTP连接性能"></a><strong>提高HTTP连接性能</strong></h3><p><strong>并行连接：</strong>通过多条TCP连接发起并发的HTTP请求</p>
<p><strong>持久连接：</strong>keep-alive,长连接，重用TCP连接，以消除连接和关闭的时延,以事务个数和时间来决定是否关闭连接</p>
<p><strong>管道化连接：</strong>通过共享TCP连接发起并发的HTTP请求</p>
<p><strong>复用的连接：</strong>交替传送请求和响应报文（实验阶段）</p>
<p><strong>串行连接：</strong></p>
<p><img src="串行连接.png" alt="串行连接"></p>
<p><strong>并行连接：</strong></p>
<p><img src="并行连接.png" alt="并行连接"></p>
<p><strong>串行、持久连接和管道化连接</strong></p>
<p><img src="持久连接.png" alt="持久连接"></p>
<h2 id="四、HTTP请求过程及相应报文格式"><a href="#四、HTTP请求过程及相应报文格式" class="headerlink" title="四、HTTP请求过程及相应报文格式"></a><strong>四、HTTP请求过程及相应报文格式</strong></h2><h3 id="一次完整的http请求处理过程"><a href="#一次完整的http请求处理过程" class="headerlink" title="一次完整的http请求处理过程"></a>一次完整的http请求处理过程</h3><p><img src="Web服务请求处理步骤.png" alt="Web服务请求处理步骤"></p>
<ol>
<li><p><strong>建立连接：</strong>接收或拒绝连接请求</p>
</li>
<li><p><strong>接收请求：</strong>接收客户端请求报文中对某资源的一次请求的过程</p>
<p>Web访问响应模型（Web I/O）</p>
<ul>
<li>单进程I/O模型：启动一个进程处理用户请求，而且一次只处理一个，多个请求被串行响应</li>
<li>多进程I/O模型：并行启动多个进程,每个进程响应一个连接请求</li>
<li>复用I/O结构：启动一个进程，同时响应N个连接请求<br>实现方法：多线程模型和事件驱动<br>   多线程模型：一个进程生成N个线程，每线程响应一个连接请求<br>   事件驱动：一个进程处理N个请求</li>
<li>复用的多进程I/O模型：启动M个进程，每个进程响应N个连接请求，同时接收M*N个请求</li>
</ul>
</li>
<li><p><strong>处理请求：</strong>服务器对请求报文进行解析，并获取请求的资源及请求方法等相关信息，根据方法，资源，<br> 首部和可选的主体部分对请求进行处理<br> <strong>元数据：</strong>请求报文首部<br>   <strong><method> <url> <version></version></url></method></strong><br> <strong>HEADERS 格式</strong> name:value<br>   <strong><request body></request></strong><br> 示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Host: www.magedu.com 请求的主机名称</span><br><span class="line">Server: Apache/2.4.7</span><br></pre></td></tr></table></figure>
<p><strong>Method:</strong> HTTP常用请求方式<br>   GET、POST、HEAD、PUT、DELETE、TRACE、OPTIONS</p>
</li>
<li><p><strong>访问资源：</strong>服务器获取请求报文中请求的资源web服务器，即存放了web资源的服务器，<br> 负责向请求者提供对方请求的静态资源，或动态运行后生成的资源资源放置于本地文件<br> 系统特定的路径：DocRoot</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DocRoot   /var/www/html</span><br><span class="line">/var/www/html/images/logo.jpg</span><br><span class="line">http://www.lvpeixin.tech/images/logo.jpg</span><br></pre></td></tr></table></figure>
<p>web服务器资源路径映射方式：<br>   a. docroot<br>   b. alias<br>   c. 虚拟主机docroot<br>   d. 用户家目录docroot</p>
</li>
<li><p><strong>构建响应报文</strong>：一旦Web服务器识别除了资源，就执行请求方法中描述的动作，并返回响应报文。<br> 响应报文中 包含有响应状态码、响应首部，如果生成了响应主体的话，还包括响应主体</p>
<ol>
<li><p>响应实体：如果事务处理产生了响应主体，就将内容放在响应报文中回送过去。</p>
<p> 响应报文中通常包括：<br>   描述了响应主体MIME类型的Content-Type首部<br>   描述了响应主体长度的Content-Length<br>   实际报文的主体内容</p>
</li>
<li><p>URL重定向：web服务构建的响应并非客户端请求的资源，而是资源另外一个访问路径</p>
<p>永久重定向：<a href="http://www.360buy.com" target="_blank" rel="noopener">http://www.360buy.com</a><br>临时重定向：<a href="http://www.taobao.com" target="_blank" rel="noopener">http://www.taobao.com</a></p>
</li>
<li><p>MIME类型：Web服务器要负责确定响应主体的MIME类型。多种配置服务器的方法可将MIME类型与资源管理起来</p>
<p><strong>魔法分类：</strong>Apache web服务器可以扫描每个资源的内容，并将其与一个已知模式表(被称为魔法文件)进行匹配，    以决定每个文件的MIME类型。这样做可能比较慢，但很方便，尤其是文件没有标准扩展名时<br><strong>显式分类：</strong>可以对Web服务器进行配置，使其不考虑文件的扩展名或内容，    强制特定文件或目录内容拥有某个MIME类型<br><strong>类型协商：</strong> 有些Web服务器经过配置，可以以多种文档格式来存储资源。在这种情况下，可以配置Web服务器，使其可以通过与用户的协商来决定使用哪种格式(及相关的MIME类型)”最好”</p>
</li>
</ol>
</li>
<li><p><strong>发送响应报文:</strong> Web服务器通过连接发送数据时也会面临与接收数据一样的问题。<br> 服务器可能有很多条到各个客户端的连接，有些是空闲的，有些在向服务器发送数据，<br> 还有一些在向客户端回送响应数据。服务器要记录连接的状态，还要特别注意对持久连接的处理。<br> 对非持久连接而言，服务器应该在发送了整条报文之后，关闭自己这一端的连接。<br> 对持久连接来说，连接可能仍保持打开状态，在这种情况下，服务器要正确地计算Content-Length首部，<br> 不然客户端就无法知道响应什么时候结束了</p>
</li>
<li><p><strong>记录日志:</strong> 最后，当事务结束时，Web服务器会在日志文件中添加一个条目，来描述已执行的事务</p>
</li>
</ol>
<h3 id="request报文"><a href="#request报文" class="headerlink" title="request报文"></a><strong>request报文</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;method&gt; &lt;request-URL&gt; &lt;version&gt;</span><br><span class="line">&lt;headers&gt;</span><br><span class="line">&lt;entity-body&gt;</span><br></pre></td></tr></table></figure>
<p><img src="请求报文.png" alt="请求报文"></p>
<h3 id="response报文"><a href="#response报文" class="headerlink" title="response报文"></a><strong>response报文</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;version&gt; &lt;status&gt; &lt;reason-phrase&gt;</span><br><span class="line">&lt;headers&gt;</span><br><span class="line">&lt;entity-body&gt;</span><br></pre></td></tr></table></figure>
<p><img src="响应报文.png" alt="响应报文"></p>
<p><strong>Mehod属性：</strong></p>
<p>请求方法：标明客户端希望服务器对资源执行的动作</p>
<p><strong>GET：</strong>从服务器获取一个资源</p>
<p><strong>HEAD：</strong>只从服务器获取文档的响应首部</p>
<p><strong>POST：</strong>向服务器输入数据，通常会再由网关程序继续处理</p>
<p><strong>PUT：</strong>将请求的主体部分存储在服务器中，如上传文件</p>
<p><strong>DELETE：</strong>请求删除服务器上指定的文档</p>
<p><strong>TRACE：</strong>追踪请求到达服务器中间经过的代理服务器</p>
<p><strong>OPTIONS：</strong>请求服务器返回对指定资源支持使用的请求方法</p>
<p><strong>version:</strong></p>
<p>​    HTTP/<major>.<minor></minor></major></p>
<p><strong>status:</strong></p>
<p>​    三位数字，如200，301, 302, 404, 502; 标记请求处理过程中发生的情况</p>
<p><strong>reason-phrase：</strong></p>
<p>​    状态码所标记的状态的简要描述</p>
<p><strong>headers：</strong></p>
<p>每个请求或响应报文可包含任意个首部；每个首部都有首部名称，后面跟一个冒号，而后跟一个可选空格，接着是一个值</p>
<p><strong>entity-body：</strong></p>
<p>请求时附加的数据或响应时附加的数据</p>
<h2 id="五、网站访问量统计"><a href="#五、网站访问量统计" class="headerlink" title="五、网站访问量统计"></a><strong>五、网站访问量统计</strong></h2><p><strong>IP(独立IP)</strong>：即Internet Protocol,指独立IP数。一天内来自相同客户机IP地址只计算一次，记录远程客户机IP地址的计算机访问网站的次数，是衡量网站流量的重要指标</p>
<p><strong>PV(访问量)</strong>： 即Page View, 页面浏览量或点击量，用户每次刷新即被计算一次，PV反映的是浏览某网站的页面数，PV与来访者的数量成正比，PV并不是页面的来访者数量，而是网站被访问的页面数量</p>
<p><strong>UV(独立访客)</strong>：即Unique Visitor,访问网站的一台电脑为一个访客。一天内相同的客户端只被计算一次。可以理解成访问某网站的电脑的数量。网站判断来访电脑的身份是通过来访电脑的cookies实现的。如果更换了IP后但不清除cookies，再访问相同网站，该网站的统计中UV数是不变的</p>
<p>网站统计：<a href="http://www.alexa.cn/rank/" target="_blank" rel="noopener">http://www.alexa.cn/rank/</a></p>
<h3 id="网站访问统计示例："><a href="#网站访问统计示例：" class="headerlink" title="网站访问统计示例："></a><strong>网站访问统计示例：</strong></h3><p>甲乙丙三人在同一台通过ADSL上网的电脑上（中间没有断网），分别访问<a href="http://www.lvpeixin.tech" target="_blank" rel="noopener">www.lvpeixin.tech</a> 网站，</p>
<p>并且每人各浏览了2个页面，那么网站的流量统计是：</p>
<p><strong>IP: 1   PV:6   UV:1</strong></p>
<p>若三人都是ADSL重新拨号后,各浏览了2个页面，则</p>
<p><strong>IP: 3   PV:6   UV:1</strong></p>
<p><strong>QPS</strong>：request per second，每秒请求数</p>
<p><strong>QPS= PV* 页⾯衍生连接次数/ 统计时间（86400）</strong></p>
<p><strong>并发连接数 =QPS * http平均响应时间</strong></p>
<p><strong>峰值时间：</strong>每天80%的访问集中在20%的时间里，这20%时间为峰值时间</p>
<p><strong>峰值时间每秒请求数(QPS)=( 总PV数 *页⾯衍⽣连接次数）<em>80% ) / ( 每天秒数</em> 20% )</strong></p>
<h2 id="六、HTTP状态码"><a href="#六、HTTP状态码" class="headerlink" title="六、HTTP状态码"></a><strong>六、HTTP状态码</strong></h2><p><strong>HTTP状态码</strong>由三个十进制数字组成，第一个十进制数字定义了状态码的类型，后两个数字没有分类的作用。</p>
<h3 id="HTTP状态码共分为5种类型："><a href="#HTTP状态码共分为5种类型：" class="headerlink" title="HTTP状态码共分为5种类型："></a>HTTP状态码共分为5种类型：</h3><p><img src="状态码分类.png" alt="状态码分类"></p>
<h3 id="HTTP状态码列表："><a href="#HTTP状态码列表：" class="headerlink" title="HTTP状态码列表："></a>HTTP状态码列表：</h3><p>​    1：信息</p>
<p><img src="1-27.png" alt="1"></p>
<p>​    2：成功</p>
<p><img src="2-29.png" alt="2"></p>
<p>​    3：重定向</p>
<p><img src="3-29.png" alt="3"></p>
<p>​    4：客户端错误</p>
<p><img src="4-1-1.png" alt="4-1"></p>
<p><img src="4-2-2.png" alt="4-2"></p>
<p>​    5：服务器错误</p>
<p><img src="5-23.png" alt="5"></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/http/" rel="tag"># http</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/06/18/MySQL之主从复制相关实验/" rel="next" title="MySQL之主从复制相关实验">
                <i class="fa fa-chevron-left"></i> MySQL之主从复制相关实验
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/06/21/Apache介绍及常用配置/" rel="prev" title="Apache介绍及常用配置">
                Apache介绍及常用配置 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">吕培新</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">71</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">41</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#一、套接字概念"><span class="nav-number">1.</span> <span class="nav-text">一、套接字概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#套接字相关的系统调用："><span class="nav-number">1.1.</span> <span class="nav-text">套接字相关的系统调用：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二、HTTP相关术语"><span class="nav-number">2.</span> <span class="nav-text">二、HTTP相关术语</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#URN与URL区别："><span class="nav-number">2.1.</span> <span class="nav-text">URN与URL区别：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#URL的组成"><span class="nav-number">2.2.</span> <span class="nav-text">URL的组成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP的历史"><span class="nav-number">2.3.</span> <span class="nav-text">HTTP的历史</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#三、HTTP工作机制"><span class="nav-number">3.</span> <span class="nav-text">三、HTTP工作机制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#工作机制："><span class="nav-number">3.1.</span> <span class="nav-text">工作机制：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie"><span class="nav-number">3.2.</span> <span class="nav-text">Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Web资源：web-resource"><span class="nav-number">3.3.</span> <span class="nav-text">Web资源：web resource</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#提高HTTP连接性能"><span class="nav-number">3.4.</span> <span class="nav-text">提高HTTP连接性能</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#四、HTTP请求过程及相应报文格式"><span class="nav-number">4.</span> <span class="nav-text">四、HTTP请求过程及相应报文格式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#一次完整的http请求处理过程"><span class="nav-number">4.1.</span> <span class="nav-text">一次完整的http请求处理过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#request报文"><span class="nav-number">4.2.</span> <span class="nav-text">request报文</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#response报文"><span class="nav-number">4.3.</span> <span class="nav-text">response报文</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#五、网站访问量统计"><span class="nav-number">5.</span> <span class="nav-text">五、网站访问量统计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#网站访问统计示例："><span class="nav-number">5.1.</span> <span class="nav-text">网站访问统计示例：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#六、HTTP状态码"><span class="nav-number">6.</span> <span class="nav-text">六、HTTP状态码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP状态码共分为5种类型："><span class="nav-number">6.1.</span> <span class="nav-text">HTTP状态码共分为5种类型：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP状态码列表："><span class="nav-number">6.2.</span> <span class="nav-text">HTTP状态码列表：</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">吕培新</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
